<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EmojiPick — Party Mode</title>
  <link rel="stylesheet" href="styles.v11.css?v=20260205v01" />
  <link rel="icon" href="./icon-192.png">
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
     <div class="logo" aria-hidden="true">
      <img src="./icon-192.png" alt="" style="width:28px;height:28px;border-radius:8px;display:block;">
      </div>

        <div>
          <div class="brandName">EmojiPick</div>
          <div class="brandTag">Party Mode (Multi-phone)</div>
        </div>
      </div>

      <div class="row" style="gap:8px; flex-wrap: wrap; justify-content: flex-end;">
        <a class="linkBtn" href="./index.html">Home</a>
        <a class="linkBtn" href="./about.html">About</a>
      </div>
    </header>

    <main class="content">
      <section class="card">

        <!-- STEP 0: ENTRY -->
        <section id="viewEntry" class="panel">
          <div class="h2">Party Mode</div>
          <div class="muted" style="margin-top:6px;">
            Create a room as host, or join with a room code.
          </div>

          <div class="divider"></div>

          <div class="row gap" style="flex-wrap: wrap;">
            <button id="btnCreateRoom" class="primary" type="button">Create room (Host)</button>
          </div>

          <div class="divider"></div>

          <div class="row gap" style="flex-wrap: wrap;">
            <input id="inpRoomCode" class="input" placeholder="Room code (e.g., A7K3)" style="min-width:200px;" />
            <input id="inpName" class="input" placeholder="Your name (e.g., Mike)" style="min-width:200px;" />
            <button id="btnJoinRoom" class="secondary" type="button">Join</button>
          </div>

          <div class="micro" style="margin-top:10px;">
            Tip: You can also open a link like <span class="muted">partymode.html?room=A7K3</span>
          </div>
        </section>

        <!-- STEP 1: LOBBY -->
        <section id="viewLobby" class="panel" hidden>
          <div class="row between">
            <div>
              <div class="h2">Lobby</div>
              <div class="muted">Room: <b id="lblRoomCode">—</b></div>
            </div>
            <div class="row gap" style="flex-wrap: wrap; justify-content:flex-end;">
              <button id="btnCopyInvite" class="secondary" type="button">Copy invite link</button>
              <button id="btnStart" class="primary" type="button" hidden>Start</button>
            </div>
          </div>

          <div class="divider"></div>

          <div class="muted">Players</div>
          <div id="playerList" style="margin-top:10px;"></div>

          <div class="divider"></div>

          <div class="row gap" style="flex-wrap: wrap;">
            <label class="muted">Game:</label>
            <select id="selGame" class="input" style="min-width:200px;">
              <option value="pb" selected>Powerball</option>
              <option value="mm">Mega Millions</option>
            </select>
          </div>

          <div class="micro" style="margin-top:10px;">
            Host can start when everyone joined.
          </div>
        </section>

        <!-- STEP 2: PICK -->
        <section id="viewPick" class="panel" hidden>
          <div class="row between">
            <div>
              <div class="h2">Pick your emojis</div>
              <div class="muted">Choose 6 emojis, then submit.</div>
            </div>
            <div class="counter"><span id="pickedCount">0</span>/6</div>
          </div>

          <div class="divider"></div>

          <!-- Reuse existing grid style -->
          <div id="emojiGridParty" class="emojiGrid" aria-label="Emoji grid"></div>

          <div class="row gap" style="margin-top: 14px;">
            <button id="btnResetParty" class="secondary" type="button">Reset</button>
            <button id="btnSubmitParty" class="primary" type="button" disabled>Submit</button>
          </div>

          <div class="divider"></div>
          <div class="muted">Submitted: <b id="lblSubmitted">0</b>/<b id="lblTotal">0</b></div>

          <div class="row gap" style="margin-top: 12px; flex-wrap: wrap;">
            <button id="btnReveal" class="primary" type="button" hidden>Reveal results (Host)</button>
          </div>
        </section>

        <!-- STEP 3: RESULT -->
        <section id="viewResult" class="panel" hidden>
          <div class="row between">
            <div>
              <div class="h2">Results</div>
              <div class="muted">Room: <b id="lblRoomCode2">—</b></div>
            </div>
            <a class="linkBtn" href="./index.html">Back to Home</a>
          </div>

          <div class="divider"></div>

          <div class="resultCard" id="partyResultCard">
            <div class="h3" style="margin-bottom:6px;">Winning numbers (for this party)</div>
            <div id="partyNumbers" class="numbers">—</div>
            <div id="partyFortune" class="fortune" style="margin-top:10px;">—</div>
          </div>

          <div class="divider"></div>

          <div class="h3">Ranking</div>
          <div id="rankingList" style="margin-top:10px;"></div>

          <div class="row gap" style="margin-top: 14px;">
            <button id="btnCopyPartyLink" class="secondary" type="button">Copy room link</button>
            <button id="btnCopyTicketParty" class="secondary" type="button">Copy as ticket (later)</button>
          </div>

          <div class="micro" style="margin-top:10px;">
            Copy-as-ticket will be added after Party v1 is stable.
          </div>
        </section>

      </section>
    </main>

    <footer class="footer">
      <div class="muted">© <span id="year"></span> EmojiPick. Entertainment only.</div>
    </footer>
  </div>

  <!-- IMPORTANT:
       You must ensure firebase is available to this page.
       Option A) If you already load app.v11.js on all pages, keep it.
       Option B) If party mode is separate, load firebase init module here.
  -->

  <!-- If your firebase init is in app.v11.js and it exposes window.db or similar, keep this. -->

   <!-- Firebase (compat) -->

  <!-- Party mode logic -->
<!-- 1) Firebase compat 라이브러리: 먼저 로드 -->
<!-- Party mode logic -->

<!-- 1) Firebase compat: 딱 1번만 -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<!-- 2) Firebase init: 딱 1번만 -->
<script>
  const firebaseConfig = {
  apiKey: "AIzaSyAVYc_K5ahGZ6TKpL4qUF0jXP16xtPOdww",
  authDomain: "localboost-dev.firebaseapp.com",
  projectId: "localboost-dev",
  storageBucket: "localboost-dev.firebasestorage.app",
  messagingSenderId: "262055028680",
  appId: "1:262055028680:web:197f41affc87849d87c2fd"
};

  firebase.initializeApp(firebaseConfig);
  window.db = firebase.firestore();
  window.__FIREBASE_READY__ = true;
</script>

<!-- 3) Party mode JS: 마지막에 -->
<script src="./partymode.v1.js?v=20260205v03"></script>


</body>
</html>
